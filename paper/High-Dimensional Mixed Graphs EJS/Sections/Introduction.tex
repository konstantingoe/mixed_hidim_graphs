Graphical models are widely used in the analysis of multivariate data, providing a convenient and interpretable way to study relationships among potentially large numbers of variables. They are key tools in modern statistics and machine learning and play an important role in diverse applications. Undirected graphical models are used in a wide range of settings, including, among others, systems biology, omics, deep phenotyping \citep[see, e.g.][]{dobra2004, Finegold11, monti2014}
and as a component within other analyses including two-sample testing, unsupervised learning, hidden Markov modeling and more  \citep[examples include][]{wei2007,verzelen2009,stadler2013, stadler2015,perrakis2021}.

A significant portion of the literature on graphical models has concentrated on scenarios where either only continuous variables or only discrete variables are present.
Regarding the former case, Gaussian graphical models have been extensively studied, including in the high-dimensional regime \citep[see among others][]{Meinshausen06, Friedman08, Banerjee08, Lam09, Yuan10, Ravikumar11, Cai11}. In such models, it is assumed that the observed random vector follows a multivariate Gaussian distribution and the graph structure of the model is given by the zero-pattern in the inverse covariance matrix. Generalizations for continuous, non-Gaussian data have also been studied \citep{Miyamura06, Liu09, Finegold11}. In the latter case, discrete graphical models -- related to Ising-type models in statistical physics -- have also been extensively studied \citep[see e.g.][]{wainwright2006, ravikumar2010}.

However, in many applications, it is common to encounter data that entail \textit{mixed} variable types, i.e. where the data vector includes components that are of different types (e.g. continuous-Gaussian, continuous-non-Gaussian, count, binary etc.). Such "column heterogeneity" (from the usual convention of samples in rows and variables in columns) is the rule rather than the exception.
%For example in biomedicine mixed data arise from the diversity of data acquisition tools and approaches, including, among others, imaging, sequencing-based omics, array-based molecular assays, blood tests, questionnaires, clinical records and more.
For instance, in statistical genetics, the construction of regulatory networks using expression profiling of genes may involve jointly analyzing gene expression levels alongside categorical phenotypes. Similarly, diagnostic data in many medical applications may contain continuous measurements such as blood pressure as well as discrete information about disease status or pain levels for example.
In analyzing such data, it is often of interest to estimate a joint multivariate graphical model spanning the various variable types. In practice, this is sometimes done using \textit{ad hoc} pipelines and data transformations. However, in graphical modeling, since the model output is intended to be scientifically interpretable and involves statements about properties such as conditional independence between variables, the use of \textit{ad hoc} workflows without an understanding of the resulting estimation properties is arguably problematic.

There have been three main lines of work that tackle high-dimensional graphical modeling for mixed data. The earliest approach is conditional Gaussian modeling of a mix of categorical and continuous data \citep{Lauritzen96} as treated by \citet{Cheng17, Lee15}. A second approach is to employ neighborhood selection which amounts to separate modeling of conditional distributions for each variable given all others \citep[see e.g.][]{Chen15, Yang14, Yang19}. A third approach uses latent Gaussian models with a key recent reference being the paper of \citet{Fan17} who proposed a latent Gaussian copula model for mixed data. The generative structure in their work posits that the discrete data is obtained from latent continuous variables thresholded at certain (unknown) levels.  However, in \citet{Fan17} only a mix of binary and continuous data is considered. Their setting does not allow for more general combinations (including counts or ordinal variables) as found in many real-world applications.

% several recent works that extend high-dimensional graphical modeling framework in a mixed data direction. A key paper is that of \citet{Fan17} who proposed a latent Gaussian copula model for mixed data, whose generative structure posits that the discrete data is obtained from latent continuous variables thresholded at certain (unknown) levels. However, they consider only a mix of binary and continuous data and do not allow for more general combinations (counts, non-Gaussian continuous variables etc.) as seen in many real-world applications.
% Conditional Gaussian models \citep[see][]{Lauritzen96} can often not be utilized in practice, due to the need for high-dimensional estimation.

This third approach will be the focus of this paper, which aims to provide a simple framework for working with latent Gaussian copula models to analyze general mixed data.
%Motivated by the foregoing observations, in this paper we study the problem of estimating undirected graphical model structure from high-dimensional data that has mixed variable types.
%In other words, we are interested in learning graphical model structure in a potentially high-dimensional setting where we explicitly allow for the presence of different kinds of variables within a single model.
To do so, we combine classical ideas concerning polychoric and polyserial correlations with approaches from the high-dimensional graphical models and copula literature. As we discuss below, this provides an overall framework that is scalable, general, and straightforward from the user's point of view.

Already in the early 1900s, \citet{Pearson1900, Pearson13} worked on the foundations of these ideas in the form of the tetrachoric and biserial correlation coefficients. From these arose the maximum likelihood estimators (MLEs) for the general version of these early ideas, namely the polychoric and the polyserial correlation coefficients.
%The former arose as a series estimator of bivariate normal correlation, where one only observes a $2\times2$ contingency table. Later, \citet{Hamdan70} showed that the series estimator is equivalent to the maximum likelihood estimator (MLE) of the latent normal correlation parameter. Moreover, \citet{Hamdan68} was able to show that the tetrachoric series estimator is a special case of the polychoric series estimator for general $r \times s$ tables. Finally, \citet{Olsson79} proposed two superior estimation methods, namely full MLE and two-step ML estimation.

%The biserial correlation coefficient, that is the product-moment correlation between a binary and a continuous variable, saw renewed attention from \citet{Tate55}, after Pearson's early work in the form of the generalization of the biserial (namely the polyserial) correlation. Later, \citet{Cox74} derived MLE and asymptotic covariance matrix of the polyserial correlation. And similar to the polychoric case, \citet{Olsson82} develop a two-step approximation to the MLE. It is these two two-step approaches that we will bring to bear in the subsequent development of our procedure.

One drawback of these original measures is that they have been proposed in the context of latent Gaussian variables.
%reliance on the Gaussianity assumption which is often too restrictive in practice.
A richer distributional family is the nonparanormal proposed by \citet{Liu09} as a nonparametric extension to the Gaussian family. A random vector $\boldsymbol{X} \in \mathbb{R}^d$ is a member of the nonparanormal family when $f(\boldsymbol{X}) = (f_{1}(X_{1}), \dots, f_{d}(X_{d}))^{T}$ is Gaussian, where $\{f_{k}\}_{k=1}^{d}$ is a set of univariate monotone transformation functions. Moreover, if the $f_j$'s are monotone and differentiable, the nonparanormal family is equivalent to the Gaussian copula family. As the polychoric and polyserial correlation assumes that observed discrete data are generated from latent continuous variables, they adhere to a latent copula approach.

We propose two estimators of the latent correlation matrix which can subsequently be plugged into existing routines to estimate the precision matrix such as the graphical LASSO (glasso) \citep{Friedman08}, CLIME \citep{Cai11}, or the graphical Dantzig selector \citep{Yuan10}. The first one is appropriate under a latent Gaussian model and simply unifies the aforementioned MLEs. The second one is more general and is applicable under the latent Gaussian copula model. Both approaches can deal with discrete variables with a general number of levels.
%This means that a practitioner can apply the approach in an ``out of the box" manner to essentially arbitrary mixed data without having to carry out any further steps to derive any special form of the estimator.
We show that both estimators exhibit favorable theoretical properties and include simulation as well as real data results. Thus, the main contributions of the paper are as follows:
\begin{itemize}
%\item We put forward methodology for the estimation of high-dimensional undirected graphical %model structure from mixed data spanning potentially many different variable types. To the %best of our knowledge our work represents the first approach that allows high-dimensional %graphical modeling for fully general mixed data.
\item We posit that integrating polychoric and polyserial correlations into the latent Gaussian copula framework offers an elegant, straightforward, and highly effective approach to graphical modeling for comprehensively diverse mixed data sets.
\item We present theoretical findings on the performance of the proposed estimators, encompassing their behavior in high-dimensional scenarios. The concentration results underscore the statistical validity of the introduced procedures.
\item We empirically examine the estimators through a series of simulations and a practical example involving real phenotyping data of mixed types sourced from the UK Biobank. Our findings illustrate the practical utility of the proposed methods, demonstrating that their performance often closely aligns with an oracle model granted access to true latent data.
\end{itemize}

Our findings provide users with a method for conducting statistically sound graphical modeling of mixed data that is both straightforward to implement and carries no more overhead than conventional high-dimensional Gaussian graphical modeling approaches. Notably, there is no requirement for manually specifying variable-type-specific model components, such as bridge functions, streamlining the modeling process.

The remainder of this paper is organized as follows. In Sections \ref{sec::gaussian} and \ref{sec::nonparanormal} we present the estimators based on polychoric and polyserial correlations, including theoretical guarantees in terms of concentration inequalities. In Section \ref{sec::setup} we describe the experimental setup used to test the proposed approaches on simulated data with the results themselves appearing in Section \ref{sec::results}. Section \ref{sec::empirical_application} showcases an illustrative empirical application using real data from the UK Biobank. We conclude with a summary of our findings and point towards our \texttt{R} package \pkg{hume}, providing users with a convenient implementation of the methods developed in this study.

